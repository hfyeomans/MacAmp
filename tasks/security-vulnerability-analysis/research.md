# Security Vulnerability Analysis - Research

## Codebase Overview

MacAmp is a macOS Winamp clone written in Swift that processes skin files (.wsz format - ZIP archives) containing:
- BMP/PNG image files for UI sprites
- Text configuration files (PLEDIT.TXT, VISCOLOR.TXT)
- EQ preset files (.EQF format)

## Key Security Components Analyzed

### 1. File Processing Components
- **SkinManager.swift**: ZIP archive extraction and image processing
- **PLEditParser.swift**: Text file parsing for playlist styling
- **VisColorParser.swift**: Color configuration parsing
- **EQF.swift**: Binary EQ preset file parsing
- **ImageSlicing.swift**: Image cropping and manipulation

### 2. Security Context
- **Sandbox**: App Store sandbox with limited file system access
- **File Access**: User-selected files, downloads folder, application support
- **Network**: Client access enabled for potential skin downloads
- **Audio**: Output device access only

## Attack Surface Analysis

### Primary Attack Vectors
1. **Malicious Skin Files**: Users can import custom .wsz files
2. **ZIP Archive Processing**: Extraction without proper validation
3. **Image Processing**: BMP/PNG loading without size limits
4. **Text Parsing**: Configuration file parsing without input sanitization
5. **Binary Parsing**: EQF file format parsing

### Trust Boundaries
- **Untrusted Input**: All skin files and user-provided content
- **Trusted Code**: Application logic and system APIs
- **Sandbox Boundary**: File system and network access limits

## Vulnerability Categories Identified

1. **Resource Exhaustion**: Unlimited file sizes, memory allocation
2. **Path Traversal**: ZIP archive entry names
3. **Buffer Overflows**: Image processing, binary parsing
4. **Injection Attacks**: Text parsing, format strings
5. **Integer Overflow**: Array indexing, size calculations
6. **Denial of Service**: CPU/memory exhaustion

## Security Controls in Place

### Positive Security Controls
- Swift memory safety (bounds checking, ARC)
- App Store sandbox limitations
- File type restrictions (.wsz only)
- Error handling with fallbacks

### Missing Security Controls
- No file size limits
- No ZIP entry validation
- No image dimension limits
- No memory usage monitoring
- No input sanitization for text parsing